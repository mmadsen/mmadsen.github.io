
<!DOCTYPE html>
<html lang="en">
  <head prefix="dc: http://purl.org/dc/terms/ og: http://ogp.me/ns#">
    <meta charset="utf-8"/>
    <title>Identifying Metapopulation Models from Simulated CT and Seriations</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
    <meta name="description" content="Lab Notebook for Mark E. Madsen"/>
    <meta name="author" content="Mark E. Madsen"/>

	<!-- Get date last modified from git log. (Uses current time if file entry not found, e.g. projects/)  -->
	


	<!-- For posts, page.date is the date they are published under, which we use as their 'canonical' dc:date -->
	 
	  
	  

	<!-- Posts declare modified timestamps in the sidebar, so would be redundant to put here. But then 
	     pages don't have a dc:modified... unless we give them their own (modified) sidebar?  
	-->
	<!-- Ideally we would want date originally created from the _oldest_ git commit too...-->

	<!-- RDFa Metadata (in DublinCore) -->
	<meta property="dc:title" content="Identifying Metapopulation Models from Simulated CT and Seriations" />
	<meta property="dc:creator" content="Mark E. Madsen" />
	<meta property="dc:date" content="2016-02-14T00:00:00-08:00" />
	<meta property="dc:format" content="text/html" />
	<meta property="dc:language" content="en" />
	<meta property="dc:identifier" content="/project:coarse%20grained%20model/model:seriationct/experiment:experiment-seriation-classification/2016/02/14/seriation-classification-experiment.html" />
	<meta property="dc:rights" content="CC BY-NC-SA 3.0" />
	<meta property="dc:source" content="Lab Notebook for Mark E. Madsen" />
	<meta property="dc:subject" content="Anthropology" /> 
	<meta property="dc:type" content="website" /> 
	<!-- RDFa Metadata (in OpenGraph) -->
	<meta property="og:title" content="Identifying Metapopulation Models from Simulated CT and Seriations" />
	<meta property="og:author" content="http://notebook.madsenlab.org/bio.html" />  <!-- Should be Liquid? URI? -->
	<meta property="og:site_name" content="Lab Notebook for Mark E. Madsen" /> <!-- Same as dc:source? -->
	<meta property="og:url" content="http://notebook.madsenlab.org/project:coarse%20grained%20model/model:seriationct/experiment:experiment-seriation-classification/2016/02/14/seriation-classification-experiment.html" />
	<meta property="og:type" content="website" /> 
	<!-- Google Scholar Metadata -->
	<meta name="citation_author" content="Mark E. Madsen"/>
	<meta name="citation_date" content="2016-02-14T00:00:00-08:00"/>
	<meta name="citation_title" content="Identifying Metapopulation Models from Simulated CT and Seriations"/>
	<meta name="citation_journal_title" content="Lab Notebook for Mark E. Madsen"/>

    <!-- Le styles -->
    <link href="/assets/css/bootstrap.css" rel="stylesheet">
    <link href="/assets/css/octicons.css" rel="stylesheet">
    <style type="text/css">
      body {
        padding-top: 60px;
        padding-bottom: 40px;
      }
      .sidebar-nav {
        padding: 9px 0;
      }

      @media (max-width: 980px) {
        /* Enable use of floated navbar text */
        .navbar-text.pull-right {
          float: none;
          padding-left: 5px;
          padding-right: 5px;
        }
      }
    </style>
    <link href="/assets/css/bootstrap-responsive.css" rel="stylesheet">
    <link href="/css/syntax.css" rel="stylesheet">
    
  <script type="text/javascript" src="//use.typekit.net/xtg2arw.js"></script>
  <script type="text/javascript">try{Typekit.load();}catch(e){}</script>
  <script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
  <script>
  MathJax.Hub.Config({
    showProcessingMessages: false,
    jax: ["input/TeX", "output/HTML-CSS"],
    tex2jax: {
      skipTags: ['script', 'noscript', 'style', 'textarea', 'pre']
    }
  });
  MathJax.Hub.Queue(function() {
    var all = MathJax.Hub.getAllJax(), i;
    for(i=0; i < all.length; i += 1) {
      all[i].SourceElement().parentNode.className += ' has-jax';
    }
  });
  </script>
<!-- Google Analytics -->
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-11944342-4', 'madsenlab.org');
  ga('send', 'pageview');

</script>

    <!-- HTML5 shim, for IE6-8 support of HTML5 elements -->
    <!--[if lt IE 9]>
      <script src="../assets/js/html5shiv.js"></script>
    <![endif]-->

    <!-- Fav and touch icons -->
    <link rel="apple-touch-icon-precomposed" sizes="144x144" href="../assets/ico/apple-touch-icon-144-precomposed.png">
    <link rel="apple-touch-icon-precomposed" sizes="114x114" href="../assets/ico/apple-touch-icon-114-precomposed.png">
      <link rel="apple-touch-icon-precomposed" sizes="72x72" href="../assets/ico/apple-touch-icon-72-precomposed.png">
                    <link rel="apple-touch-icon-precomposed" href="../assets/ico/apple-touch-icon-57-precomposed.png">
                                   <link rel="shortcut icon" href="../assets/ico/favicon.png">
  </head>

  <body>

    <div class="navbar navbar-inverse navbar-fixed-top">
      <div class="navbar-inner">
        <div class="container-fluid">
          <button type="button" class="btn btn-navbar" data-toggle="collapse" data-target=".nav-collapse">
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a class="brand" href="/">MadsenLabNotebook</a>
          <div class="nav-collapse collapse">
                  <!-- Search site using Google's index -->
      <form class="navbar-search pull-right" method="get" action="http://google.com/search">
        <p>
          <input type="hidden" name="q" value="site:notebook.madsenlab.org" />
          <input type="text" class="search-query" name="q" />
          <button class="btn btn-mini" type="submit"><i class="icon-search"></i></button> 
        </p>
      </form>
            <ul class="nav">
              <li class="active"><a href="/">Home</a></li>
              <li><a href="/bio.html">About Me</a></li>
              <li><a href="http://about.me/mark.e.madsen">Contact</a></li>
              <li><a href="/blog.html">Essays</a></li>
              <li><a href="/feed.xml">Atom/RSS Feed</a></li>
          </div><!--/.nav-collapse -->
        </div>
      </div>
    </div>

    <div class="container-fluid">
      <div class="row-fluid">
        <div class="span3">
          <div class="well sidebar-nav">
            <ul class="nav nav-list">
              <li><img src="/images/madsenlabnotebook-350px.png" class="img-responsive" alt="MadsenLab Notebook"/></li>
              <li class="nav-header">General</li>
              <li><a href="/tags.html">Notes by Tag</a></li>
              <li><a href="/allposts.html">All Notes by Date</a></li>
              <li><a href="/blog.html">Essays and General Writings</a></li>
              <li class="nav-header">Projects</li>
              <li><a href="/projects/coarsegraining/">Coarse Grained Models of CT</a></li>
              <li><a href="/projects/nicheconstruction/">Niche Construction and CT Modeling</a></li>
              <li><a href="/projects/structuredinfo/">CT of Structured Information</a></li>
              <li class="nav-header">Simulations and Experiments</li>
              <li><a href="/byexperiment.html">Notes by Experiment</a></li>
              <li><a href="/bymodel.html">Notes by Simulation Model</a></li>
              <li class="nav-header">Topics</li>
              <li><a href="/tag/cultural%20transmission.html">Cultural transmission theory</a></li>
              <li><a href="/tag/evolutionary%20theory.html">Darwinian evolutionary theory</a></li>
			        <li><a href="/tag/dissertation.html">Dissertation Research</a></li>
              <li><a href="/tag/reading%20notes.html">Reading notes</a></li>
              <li><a href="/openproblems.html">Open Research Problems</a></li>

              <li class="nav-header">Meta</li>
              <li><a href="/bio.html">Bio</a></li>
              <li><a href="/software.html">Software</a></li>
              <li><a href="/tools.html">Tools I Use</a></li>
              <li><a href="/publications.html">Publications</a></li>
              <li><a href="/openscience.html">About Open Science</a></li>
			<li><a href="/labnotebook.html">About this Notebook</a></li>
            </ul>
          </div><!--/.well -->
        </div><!--/span3-->

            <div class="span8">
  	<h2>Identifying Metapopulation Models from Simulated CT and Seriations</h2>
	

		<p class="text-info">
		<table class="table table-condensed">
			<tr class="info">
				<td><small><i class="icon-calendar"></i>&nbsp;Created: 14 Feb 2016</small></td>
				<td><small><i class="icon-calendar"></i>&nbsp;Modified: 16 Feb 2016</small></td>
				<td><small><i class="icon-book">&nbsp;</i>&nbsp;<a href=http://greycite.knowledgeblog.org/bib/?uri=http://notebook.madsenlab.org/project:coarse%20grained%20model/model:seriationct/experiment:experiment-seriation-classification/2016/02/14/seriation-classification-experiment.html target='_blank'>BibTeX Entry</a>
</small></td>
				<td><small><i class="icon-book">&nbsp;</i>&nbsp;<a href=http://greycite.knowledgeblog.org/ris/?uri=http://notebook.madsenlab.org/project:coarse%20grained%20model/model:seriationct/experiment:experiment-seriation-classification/2016/02/14/seriation-classification-experiment.html target='_blank'>RIS Citation</a>
</small></td>
				<td><small><a href="javascript:window.print()"><i class="icon-print"></i>&nbsp;Print</a></small></td>
				<!--<td><small><a href="/project:coarse%20grained%20model/model:seriationct/experiment:experiment-seriation-classification/2016/02/14/seriation-classification-experiment.html"></i>Permalink</a></small></td> -->
			</tr>
		</table>
		</p>


  	
	
  <h3 id="background">Background</h3>
<p>In a <a href="http://notebook.madsenlab.org/project:coarse%20grained%20model/model:seriationct/experiment:experiment-seriationct/2016/01/26/quantifying-similarity-seriations.html">previous note</a>, I described the problem of inferring the goodness of fit between a regional network model and the sampled output of cultural transmission on that regional network, as measured through seriations. I am now ready with the simulation and inference code to start testing the spectral similarity metric I discussed in that note across pairs and sets of regional network models.</p>
<p>Here, I describe the first such comparison.</p>
<h3 id="experiment-sc-1">Experiment: SC-1</h3>
<p>SC-1 is a simple contrast between two regional network models. A regional network model is a time-transgressive description of the interaction patterns that existed among a set of subpopulations, described by an “interval temporal network” representation (see <a href="http://notebook.madsenlab.org/project:coarse%20grained%20model/model:seriationct/experiment:experiment-seriationct/2014/11/28/more-temporal-networks-python.html">note 2</a> and <a href="http://notebook.madsenlab.org/project:coarse%20grained%20model/model:seriationct/experiment:experiment-seriationct/2014/07/28/implementing-temporal-networks-in-python.html">note 1</a> about the implementation of such models).</p>
<p>Both models are composed of 10 time slices.</p>
<p>Model #1 is called “linear” in the experiment directory because it should ideally yield simple, linear seriation solutions because the only thing occurring is sampling through time. At any given time, the metapopulation is composed of 64 subpopulations each. Each subpopulation is fully connected, so that any subpopulation can exchange migrants with any other, and there are no differences in edge weights (and thus migration rates). Each subpopulation in slice <span class="math">\(N\)</span> is the child of a random subpopulation in slice <span class="math">\(N-1\)</span>.</p>
<p>Model #2 is called “lineage” in the experiment directory because it features 4 clusters of subpopulations, with 8 subpopulations per cluster. Subpopulations are fully connected within a cluster, with edge weight 10. Subpopulations are connected between subpopulations at fraction 0.1, with edge weight 1. This yields a strong tendency to exchange migrants within clusters, and at a much lower rate between clusters. For the first 4 time slices, all four clusters of subpopulations are interconnected, but in slice 4, a “split” occurs, removing interconnections between two sets of clusters, leaving <span class="math">\({1,2}\)</span> interconnected and <span class="math">\({3,4}\)</span> interconnected, but no connections between these sets. The resulting clusters then evolve for 6 more time slices on separate trajectories, giving rise to a “lineage split.”</p>
<p>Neutral cultural transmission is simulated across these two network models, with 50 simulation replicates on each model, and a common set of parameters:</p>
<pre class="sourceCode json"><code class="sourceCode json"><span class="fu">{</span>
    <span class="dt">&quot;theta_low&quot;</span><span class="fu">:</span> <span class="fl">0.00001</span><span class="fu">,</span>
    <span class="dt">&quot;theta_high&quot;</span><span class="fu">:</span> <span class="fl">0.0001</span><span class="fu">,</span>
    <span class="dt">&quot;maxinittraits&quot;</span><span class="fu">:</span> <span class="dv">5</span><span class="fu">,</span>
    <span class="dt">&quot;numloci&quot;</span><span class="fu">:</span> <span class="dv">3</span><span class="fu">,</span>
    <span class="dt">&quot;popsize&quot;</span><span class="fu">:</span> <span class="dv">250</span><span class="fu">,</span>
    <span class="dt">&quot;simlength&quot;</span><span class="fu">:</span> <span class="dv">8000</span><span class="fu">,</span>
    <span class="dt">&quot;samplefraction&quot;</span> <span class="fu">:</span> <span class="fl">0.5</span><span class="fu">,</span>
    <span class="dt">&quot;migrationfraction_low&quot;</span> <span class="fu">:</span> <span class="fl">0.05</span><span class="fu">,</span>
    <span class="dt">&quot;migrationfraction_high&quot;</span> <span class="fu">:</span> <span class="fl">0.1</span><span class="fu">,</span>
    <span class="dt">&quot;replicates&quot;</span> <span class="fu">:</span> <span class="dv">1</span>
<span class="fu">}</span></code></pre>
<p>Innovation rates and migration fractions are chosen uniformly at random from the ranges given for each simulation run. Each locus evolves randomly, but we track combinations of loci as “classes” in the archaeological sense of the term as our observable variables. Populations evolve for 8000 generations, giving approximately 800 transmission events per individual during a time slice (i.e., step in the regional metapopulation evolution). We can think of that as approximately monthly opportunities for copying artifacts or behavioral traits, over a lifetime of approximately 65 years.</p>
<p>The raw data from each community in a simulated network model are then aggregated over the duration that community persists, giving us a time averaged picture of the frequency of cultural traits.</p>
<p>I then perform the following sampling steps:</p>
<ol type="1">
<li><p>I take a sample of each time averaged data collection similar to the size of a typical archaeological surface collection: 500 samples are taken without replacement from each community, with probability proportional to class frequency. This yields a smaller set of classes, since many hundreds or thousands of combinations are only seen once or twice in the simulation data, and thus are very hard to measure from empirical samples.</p></li>
<li><p>I then take a sample of communities to seriate. From each of the two network models, I take temporally stratified samples, with 3 communities per time slice sampled out of the 64 present in each slice. In real sampling situations, we would not know how communities break down temporally, but we often do attempt to get samples of assemblages which cover our entire study duration. In the case of Model #1, we take a 5% sample of communities in each time slice. In the case of Model #2, given the different structure of the model, we take a 12% sample of communities in each time slice.</p></li>
<li><p>Within the overall sample from each simulation run, comprised now of the time averaged class frequencies from 30 sampled communities, I examine the classes/types themselves, and drop any types (columns) which do not have data values for at least 3 communities. This is standard pre-processing for seriation analyses (or was in the Fordian manual days of seriation analysis) since without more than 3 values, a column does not contribute to ordering the communities.</p></li>
</ol>
<p>The <a href="https://github.com/clipo/idss-seriation">IDSS Seriation</a> package is then used to seriate the stratified, filtered data files for each simulation run across the two models.</p>
<h3 id="first-classification-attempt">First Classification Attempt</h3>
<p>For a first classification attempt, I did a “leave one out” cross validation run, in which each seriation graph was sequentially deleted from the training set of 99 seriations (one lineage graph had issues with duplicate frequencies and became stuck in frequency seriation), and the distance from the hold-out target graph to all others calculated using <a href="http://notebook.madsenlab.org/project:coarse%20grained%20model/model:seriationct/experiment:experiment-seriationct/2016/01/26/quantifying-similarity-seriations.html">Laplacian spectral distance</a>. The label of the target graph was then predicted as the majority vote of the 5 nearest neighboring graphs. No attempt was made to tune the number of nearest neighbors using a second cross validation pass, but that will be the next experiment.</p>
<p>In general, the ability to predict the label (network model) which gave rise to the target seriation graph is decent: 76.8%.</p>
<pre><code>Classification Report:

          predicted 0  predicted 1
actual 0           41            9
actual 1           14           35
             precision    recall  f1-score   support

          0       0.75      0.82      0.78        50
          1       0.80      0.71      0.75        49

avg / total       0.77      0.77      0.77        99

Accuracy on test: 0.768</code></pre>
<p>The details of classifier accuracy seem to show that we have better ability to correctly classify seriations which result from Model #1 (“linear”) model than seriations originating from the lineage splitting Model #2. In particular, we correctly identify instances of Model #1 82% of the time (recall), although there are clear issues with false positives. The ability to identify instances of Model #2 is worse, with a considerable number of false negatives.</p>
<p>In the next experiment, I intend to see if different values of the k-Nearest Neighbor parameter affect this accuracy, but I expect that achieving higher accuracy might require augmenting the approach. One possibility that bears exploration is to not simply use the spectral distance, but to instead use the Laplacian eigenvalues themselves (sorted in decreasing order) directly as features, in addition to other graph theoretic properties such as average degree and tree radius, and use a more traditional classifier like boosted decision trees. That will probably be my third experiment.</p>
<h3 id="second-attempt">Second Attempt</h3>
<p>In a second run, I examined the effect of the number of nearest neighbors which “vote” on the label of the target seriation, still with leave-one-out cross validation. The results seem to indicate that (at least for these models) that best performance is 3 nearest neighbors, with accuracy worsening for 5, 7, and 9 neighbors, and then plateauing a bit for 11 and 15 neighbors. But with 3 neighbors, we achieve almost 80% accuracy, which is encouraging.</p>
<pre class="sourceCode python"><code class="sourceCode python">

knn = [<span class="dv">1</span>, <span class="dv">3</span>, <span class="dv">5</span>, <span class="dv">7</span>, <span class="dv">9</span>, <span class="dv">11</span>, <span class="dv">15</span>]
<span class="kw">for</span> nn in knn:
    gclf = skm.GraphEigenvalueNearestNeighbors(n_neighbors=nn)
    test_pred = []
    <span class="kw">for</span> ix in <span class="dt">range</span>(<span class="dv">0</span>, <span class="dt">len</span>(train_graphs)):
        train_loo_graphs, train_loo_labels, test_graph, test_label = leave_one_out_cv(ix, train_graphs, train_labels)
        gclf.fit(train_loo_graphs, train_loo_labels)
        test_pred.append(gclf.predict([test_graph])[<span class="dv">0</span>])
    <span class="dt">print</span>(<span class="st">&quot;Accuracy on test for </span><span class="ot">%s</span><span class="st"> neighbors: </span><span class="ot">%0.3f</span><span class="st">&quot;</span> % (nn, accuracy_score(train_labels, test_pred)))</code></pre>
<p>Results:</p>
<pre><code>Accuracy on test for 1 neighbors: 0.788
Accuracy on test for 3 neighbors: 0.798
Accuracy on test for 5 neighbors: 0.768
Accuracy on test for 7 neighbors: 0.747
Accuracy on test for 9 neighbors: 0.758
Accuracy on test for 11 neighbors: 0.788
Accuracy on test for 15 neighbors: 0.788</code></pre>
<h3 id="resources">Resources</h3>
<p>The full Github repository for this and related seriation classification experiments is: <a href="https://github.com/mmadsen/experiment-seriation-classification">experiment-seriation-classification</a></p>
<p><a href="http://nbviewer.jupyter.org/github/mmadsen/experiment-seriation-classification/blob/master/analysis/sc-1/sc-1-seriation-classification-analysis.ipynb">Full iPython notebook</a>.</p>
<p><a href="http://nbviewer.jupyter.org/github/mmadsen/experiment-seriation-classification/blob/master/analysis/sc-1/sc-1-eigenvalue-classification-dataprep.ipynb">Data Preparation Notebook</a></p>
<div class="references">
<h3>References Cited</h3>
</div>
  


<div class="well well-small">
<p class="text-info"><i class="icon-tags"></i>&nbsp;Tags</p>
<ul>

<li><a href='/tag/cultural+transmission.html'>cultural transmission</a></li>

<li><a href='/tag/coarse+graining.html'>coarse graining</a></li>

<li><a href='/tag/simulation.html'>simulation</a></li>

<li><a href='/tag/dissertation.html'>dissertation</a></li>

<li><a href='/tag/seriation.html'>seriation</a></li>

<li><a href='/tag/algorithms.html'>algorithms</a></li>

<li><a href='/tag/ML.html'>ML</a></li>

</ul>
</div>


</div>


        
      </div><!--/row-->


    


 
      <hr>

      <footer>
		        <p>&copy; Mark E. Madsen 2011-2015    <a href="mailto:mark@madsenlab.org">Email</a>&nbsp;||
		  <a href="http://orcid.org/0000-0001-9320-8377">ORCId</a>&nbsp;||
		  <a href="http://figshare.com/authors/Mark%20Madsen/279062">Figshare</a>&nbsp;||
		    <a href="http://www.linkedin.com/profile/view?id=8751">LinkedIn</a>&nbsp;|| 	    <a href="http://github.com/mmadsen">GitHub</a>&nbsp;||
        <a href="http://www.researchgate.net/profile/Mark_Madsen3/">ResearchGate</a>&nbsp;||
        <a href="https://washington.academia.edu/MarkMadsen">Academia.edu</a>&nbsp;||
        <a href="https://zenodo.org/search?ln=en&cc=software&p=Mark+Madsen&action_search=">Zenodo</a></p>
      </footer>

    </div><!--/.fluid-container-->

    <!-- Le javascript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
    <script src="/assets/js/jquery.js"></script>
    <script src="/assets/js/bootstrap-transition.js"></script>
    <script src="/assets/js/bootstrap-alert.js"></script>
    <script src="/assets/js/bootstrap-modal.js"></script>
    <script src="/assets/js/bootstrap-dropdown.js"></script>
    <script src="/assets/js/bootstrap-scrollspy.js"></script>
    <script src="/assets/js/bootstrap-tab.js"></script>
    <script src="/assets/js/bootstrap-tooltip.js"></script>
    <script src="/assets/js/bootstrap-popover.js"></script>
    <script src="/assets/js/bootstrap-button.js"></script>
    <script src="/assets/js/bootstrap-collapse.js"></script>
    <script src="/assets/js/bootstrap-carousel.js"></script>
    <script src="/assets/js/bootstrap-typeahead.js"></script>

  </body>
</html>
