
<!DOCTYPE html>
<html lang="en">
  <head prefix="dc: http://purl.org/dc/terms/ og: http://ogp.me/ns#">
    <meta charset="utf-8"/>
    <title>CTMixtures Equifinality Analysis - Initial Ideas</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
    <meta name="description" content="Lab Notebook for Mark E. Madsen"/>
    <meta name="author" content="Mark E. Madsen"/>

	<!-- Get date last modified from git log. (Uses current time if file entry not found, e.g. projects/)  -->
	


	<!-- For posts, page.date is the date they are published under, which we use as their 'canonical' dc:date -->
	 
	  
	  

	<!-- Posts declare modified timestamps in the sidebar, so would be redundant to put here. But then 
	     pages don't have a dc:modified... unless we give them their own (modified) sidebar?  
	-->
	<!-- Ideally we would want date originally created from the _oldest_ git commit too...-->

	<!-- RDFa Metadata (in DublinCore) -->
	<meta property="dc:title" content="CTMixtures Equifinality Analysis - Initial Ideas" />
	<meta property="dc:creator" content="Mark E. Madsen" />
	<meta property="dc:date" content="2014-09-18T00:00:00-07:00" />
	<meta property="dc:format" content="text/html" />
	<meta property="dc:language" content="en" />
	<meta property="dc:identifier" content="/project:coarse%20grained%20model/model:ctmixtures/experiment:experiment-ctmixtures/2014/09/18/equifinality-initial-analysis.html" />
	<meta property="dc:rights" content="CC BY-NC-SA 3.0" />
	<meta property="dc:source" content="Lab Notebook for Mark E. Madsen" />
	<meta property="dc:subject" content="Anthropology" /> 
	<meta property="dc:type" content="website" /> 
	<!-- RDFa Metadata (in OpenGraph) -->
	<meta property="og:title" content="CTMixtures Equifinality Analysis - Initial Ideas" />
	<meta property="og:author" content="http://notebook.madsenlab.org/bio.html" />  <!-- Should be Liquid? URI? -->
	<meta property="og:site_name" content="Lab Notebook for Mark E. Madsen" /> <!-- Same as dc:source? -->
	<meta property="og:url" content="http://notebook.madsenlab.org/project:coarse%20grained%20model/model:ctmixtures/experiment:experiment-ctmixtures/2014/09/18/equifinality-initial-analysis.html" />
	<meta property="og:type" content="website" /> 
	<!-- Google Scholar Metadata -->
	<meta name="citation_author" content="Mark E. Madsen"/>
	<meta name="citation_date" content="2014-09-18T00:00:00-07:00"/>
	<meta name="citation_title" content="CTMixtures Equifinality Analysis - Initial Ideas"/>
	<meta name="citation_journal_title" content="Lab Notebook for Mark E. Madsen"/>

    <!-- Le styles -->
    <link href="/assets/css/bootstrap.css" rel="stylesheet">
    <link href="/assets/css/octicons.css" rel="stylesheet">
    <style type="text/css">
      body {
        padding-top: 60px;
        padding-bottom: 40px;
      }
      .sidebar-nav {
        padding: 9px 0;
      }

      @media (max-width: 980px) {
        /* Enable use of floated navbar text */
        .navbar-text.pull-right {
          float: none;
          padding-left: 5px;
          padding-right: 5px;
        }
      }
    </style>
    <link href="/assets/css/bootstrap-responsive.css" rel="stylesheet">
    <link href="/css/syntax.css" rel="stylesheet">
    
  <script type="text/javascript" src="//use.typekit.net/xtg2arw.js"></script>
  <script type="text/javascript">try{Typekit.load();}catch(e){}</script>
  <script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
  <script>
  MathJax.Hub.Config({
    showProcessingMessages: false,
    jax: ["input/TeX", "output/HTML-CSS"],
    tex2jax: {
      skipTags: ['script', 'noscript', 'style', 'textarea', 'pre']
    }
  });
  MathJax.Hub.Queue(function() {
    var all = MathJax.Hub.getAllJax(), i;
    for(i=0; i < all.length; i += 1) {
      all[i].SourceElement().parentNode.className += ' has-jax';
    }
  });
  </script>
<!-- Google Analytics -->
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-11944342-4', 'madsenlab.org');
  ga('send', 'pageview');

</script>

    <!-- HTML5 shim, for IE6-8 support of HTML5 elements -->
    <!--[if lt IE 9]>
      <script src="../assets/js/html5shiv.js"></script>
    <![endif]-->

    <!-- Fav and touch icons -->
    <link rel="apple-touch-icon-precomposed" sizes="144x144" href="../assets/ico/apple-touch-icon-144-precomposed.png">
    <link rel="apple-touch-icon-precomposed" sizes="114x114" href="../assets/ico/apple-touch-icon-114-precomposed.png">
      <link rel="apple-touch-icon-precomposed" sizes="72x72" href="../assets/ico/apple-touch-icon-72-precomposed.png">
                    <link rel="apple-touch-icon-precomposed" href="../assets/ico/apple-touch-icon-57-precomposed.png">
                                   <link rel="shortcut icon" href="../assets/ico/favicon.png">
  </head>

  <body>

    <div class="navbar navbar-inverse navbar-fixed-top">
      <div class="navbar-inner">
        <div class="container-fluid">
          <button type="button" class="btn btn-navbar" data-toggle="collapse" data-target=".nav-collapse">
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a class="brand" href="/">MadsenLabNotebook</a>
          <div class="nav-collapse collapse">
                  <!-- Search site using Google's index -->
      <form class="navbar-search pull-right" method="get" action="http://google.com/search">
        <p>
          <input type="hidden" name="q" value="site:notebook.madsenlab.org" />
          <input type="text" class="search-query" name="q" />
          <button class="btn btn-mini" type="submit"><i class="icon-search"></i></button> 
        </p>
      </form>
            <ul class="nav">
              <li class="active"><a href="/">Home</a></li>
              <li><a href="/bio.html">About Me</a></li>
              <li><a href="http://about.me/mark.e.madsen">Contact</a></li>
              <li><a href="/blog.html">Essays</a></li>
              <li><a href="/feed.xml">Atom/RSS Feed</a></li>
          </div><!--/.nav-collapse -->
        </div>
      </div>
    </div>

    <div class="container-fluid">
      <div class="row-fluid">
        <div class="span3">
          <div class="well sidebar-nav">
            <ul class="nav nav-list">
              <li><img src="/images/madsenlabnotebook-350px.png" class="img-responsive" alt="MadsenLab Notebook"/></li>
              <li class="nav-header">General</li>
              <li><a href="/tags.html">Notes by Tag</a></li>
              <li><a href="/allposts.html">All Notes by Date</a></li>
              <li><a href="/blog.html">Essays and General Writings</a></li>
              <li class="nav-header">Projects</li>
              <li><a href="/projects/coarsegraining/">Coarse Grained Models of CT</a></li>
              <li><a href="/projects/nicheconstruction/">Niche Construction and CT Modeling</a></li>
              <li><a href="/projects/structuredinfo/">CT of Structured Information</a></li>
              <li class="nav-header">Simulations and Experiments</li>
              <li><a href="/byexperiment.html">Notes by Experiment</a></li>
              <li><a href="/bymodel.html">Notes by Simulation Model</a></li>
              <li class="nav-header">Topics</li>
              <li><a href="/tag/cultural%20transmission.html">Cultural transmission theory</a></li>
              <li><a href="/tag/evolutionary%20theory.html">Darwinian evolutionary theory</a></li>
			        <li><a href="/tag/dissertation.html">Dissertation Research</a></li>
              <li><a href="/tag/reading%20notes.html">Reading notes</a></li>
              <li><a href="/openproblems.html">Open Research Problems</a></li>

              <li class="nav-header">Meta</li>
              <li><a href="/bio.html">Bio</a></li>
              <li><a href="/software.html">Software</a></li>
              <li><a href="/tools.html">Tools I Use</a></li>
              <li><a href="/publications.html">Publications</a></li>
              <li><a href="/openscience.html">About Open Science</a></li>
			<li><a href="/labnotebook.html">About this Notebook</a></li>
            </ul>
          </div><!--/.well -->
        </div><!--/span3-->

            <div class="span8">
  	<h2>CTMixtures Equifinality Analysis - Initial Ideas</h2>
	

		<p class="text-info">
		<table class="table table-condensed">
			<tr class="info">
				<td><small><i class="icon-calendar"></i>&nbsp;Created: 18 Sep 2014</small></td>
				<td><small><i class="icon-calendar"></i>&nbsp;Modified: 15 Feb 2016</small></td>
				<td><small><i class="icon-book">&nbsp;</i>&nbsp;<a href=http://greycite.knowledgeblog.org/bib/?uri=http://notebook.madsenlab.org/project:coarse%20grained%20model/model:ctmixtures/experiment:experiment-ctmixtures/2014/09/18/equifinality-initial-analysis.html target='_blank'>BibTeX Entry</a>
</small></td>
				<td><small><i class="icon-book">&nbsp;</i>&nbsp;<a href=http://greycite.knowledgeblog.org/ris/?uri=http://notebook.madsenlab.org/project:coarse%20grained%20model/model:ctmixtures/experiment:experiment-ctmixtures/2014/09/18/equifinality-initial-analysis.html target='_blank'>RIS Citation</a>
</small></td>
				<td><small><a href="javascript:window.print()"><i class="icon-print"></i>&nbsp;Print</a></small></td>
				<!--<td><small><a href="/project:coarse%20grained%20model/model:ctmixtures/experiment:experiment-ctmixtures/2014/09/18/equifinality-initial-analysis.html"></i>Permalink</a></small></td> -->
			</tr>
		</table>
		</p>


  	
	
  <h3 id="rough-test-1-population-data">Rough Test 1: Population Data</h3>
<p>I’m not finished with the data export program yet, working out how to flatten multiple loci and other list/nested data structures. This is particularly important since some elements are measured only once (e.g., configurations or classes) while others are measured on a per-locus basis. At the same time, there’s an element of feature selection and engineering occurring, which is happening via a trial random forest classification.</p>
<p>The population census data are fairly easy and finite, so I’ve already got them exported with an initial cut at the program, with the following predictors for the four model class labels:</p>
<ul>
<li>Slatkin exact test for the configuration or class counts in the population census</li>
<li>Number of configurations in the population at sample time</li>
<li>Per-locus Shannon entropy of trait frequencies</li>
<li>Per-locus IQV diversity of trait frequencies</li>
<li>Per-locus richness of traits</li>
<li>Kandler-Shennan traits surviving after 50 generations</li>
</ul>
<p>A very quick random forest fit on 80% of the data as training data (with typical classification values) shows that there’s a lot of error correctly classifying data points, and thus good hints of equifinality.</p>
<pre><code>Call:
 randomForest(formula = factor(model_class_label) ~ ., data = train,      ntree = 1000, nodesize = 1, mtry = 3) 
               Type of random forest: classification
                     Number of trees: 1000
No. of variables tried at each split: 3

        OOB estimate of  error rate: 48.24%
Confusion matrix:
             allneutral mixantidom mixconfdom mixconfequal class.error
allneutral        27560       1515       1986         1014   0.1407638
mixantidom         1659      14881       6724         8700   0.5344450
mixconfdom         2006       7925      13822         8173   0.5670613
mixconfequal       1665      10860       9526         9984   0.6883409</code></pre>
<p>Prediction error on the remaining 20% of the data is 0.516. But there’s an interesting pattern here, and some issues with the data export.</p>
<p>First, it doesn’t seem nearly as hard to tell neutral models from biased models, as it is to tell different bias models apart, as you’d expect. Perhaps this should be the expectation given synchronic population census. We’ll see how this plays out in synchronic sampled data, and of course TA and sampled data. But I should also do a binary classification, lumping the bias models together, and simply predicting neutral vs. bias.</p>
<p>But second, some of the values are repeated in each row, since a row represents a locus, not a simulation run. I should do further feature engineering and have only one row per simulation run in the data export, and use variables like min/max/median richness, entropy, etc. This will apply to all multilocus data.</p>
<h3 id="rough-test-2-more-variables-and">Rough Test 2: More Variables and</h3>
<p>I recoded the export script, and stopped exploding each locus into a data row. Instead, for each primary predictor, I calculate min and max (e.g., min richness and max richness) across the number of loci present. For a single locus simulation, obviously these will be the same value and we’d only use one of the two predictors and relabel them, but in <code>equifinality-1</code> we have 4 loci.</p>
<p>The random forest improves a little bit, but the overall pattern still looks the same.</p>
<p>But, the neutral data are worrying me. In <code>equifinality-1</code> I used the “all loci” copying rule, and I’m also turning the single scaled innovation rate into a per-locus innovation rate. I think there’s an issue here somewhere. Granted, with the Moran dynamics, I can’t expect that the expected number of alleles will exactly match the Wright Fisher dynamics, but the observed numbers seem high. Also, the distribution of Slatkin rest results seems skewed.<br /><img src="/images/ctmixtures-equifinality-neutral.png" alt="equifinality-1 slatkin configuration distribution" /></p>
<p>We have many different innovation rates represented here, but still, there should be many more values towards the center.</p>
<p>I’m wondering about several possible sources of issues before I go any further:</p>
<ol type="1">
<li>Is the innovation rate algorithm working properly?</li>
<li>Is the all-locus copying the way to go?</li>
</ol>
<p>The distribution of theta values looks good, when I did a histogram.</p>
<h3 id="analysis-code">Analysis Code</h3>
<p>The short script I used for the explorations here:</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(randomForest)
<span class="kw">library</span>(miscTools)

df &lt;-<span class="st"> </span><span class="kw">read.csv</span>(<span class="st">&quot;~/local-research/diss/experiments/experiment-ctmixtures/equifinality-population-data.csv&quot;</span>, <span class="dt">header=</span>T)
<span class="co"># we don&#39;t want to treat the sim run ID as one of the predictors...</span>
drops &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&#39;simulation_run_id&#39;</span>)
dataset &lt;-<span class="st"> </span>df[,!(<span class="kw">names</span>(df) %in%<span class="st"> </span>drops)]

<span class="co"># shuffle the data frame row-wise so that we can randomly sample test and training data from it</span>
shuffled_df &lt;-<span class="st"> </span>dataset[<span class="kw">sample</span>(<span class="kw">nrow</span>(dataset)),]
indexes =<span class="st"> </span><span class="kw">sample</span>(<span class="dv">1</span>:<span class="kw">nrow</span>(shuffled_df), <span class="dt">size=</span><span class="fl">0.2</span>*<span class="kw">nrow</span>(shuffled_df))
test =<span class="st"> </span>shuffled_df[indexes,]
train =<span class="st"> </span>shuffled_df[-indexes,]


fit &lt;-<span class="st"> </span><span class="kw">randomForest</span>(<span class="kw">factor</span>(model_class_label) ~<span class="st"> </span>., <span class="dt">data=</span>train, <span class="dt">ntree=</span><span class="dv">1000</span>, <span class="dt">nodesize =</span> <span class="dv">1</span>, <span class="dt">mtry=</span><span class="dv">3</span>)
<span class="kw">print</span>(fit)
<span class="co">#varImpPlot(fit)</span>

<span class="co"># evaluate on test data</span>
<span class="kw">table</span>(test$model_class_label, <span class="kw">predict</span>(fit, test[<span class="kw">names</span>(shuffled_df)]))

<span class="co"># test error</span>
<span class="kw">sum</span>(test$model_class_label==<span class="kw">predict</span>(fit, test[<span class="kw">names</span>(shuffled_df)])) /<span class="st"> </span><span class="kw">nrow</span>(test)</code></pre>
<div class="references">

</div>
  


<div class="well well-small">
<p class="text-info"><i class="icon-tags"></i>&nbsp;Tags</p>
<ul>

<li><a href='/tag/cultural+transmission.html'>cultural transmission</a></li>

<li><a href='/tag/time+averaging.html'>time averaging</a></li>

<li><a href='/tag/coarse+graining.html'>coarse graining</a></li>

<li><a href='/tag/simulation.html'>simulation</a></li>

<li><a href='/tag/dissertation.html'>dissertation</a></li>

<li><a href='/tag/open+science.html'>open science</a></li>

<li><a href='/tag/reproducible+science.html'>reproducible science</a></li>

<li><a href='/tag/experiments.html'>experiments</a></li>

<li><a href='/tag/experiment-ctmixture.html'>experiment-ctmixture</a></li>

</ul>
</div>


</div>


        
      </div><!--/row-->


    


 
      <hr>

      <footer>
		        <p>&copy; Mark E. Madsen 2011-2015    <a href="mailto:mark@madsenlab.org">Email</a>&nbsp;||
		  <a href="http://orcid.org/0000-0001-9320-8377">ORCId</a>&nbsp;||
		  <a href="http://figshare.com/authors/Mark%20Madsen/279062">Figshare</a>&nbsp;||
		    <a href="http://www.linkedin.com/profile/view?id=8751">LinkedIn</a>&nbsp;|| 	    <a href="http://github.com/mmadsen">GitHub</a>&nbsp;||
        <a href="http://www.researchgate.net/profile/Mark_Madsen3/">ResearchGate</a>&nbsp;||
        <a href="https://washington.academia.edu/MarkMadsen">Academia.edu</a>&nbsp;||
        <a href="https://zenodo.org/search?ln=en&cc=software&p=Mark+Madsen&action_search=">Zenodo</a></p>
      </footer>

    </div><!--/.fluid-container-->

    <!-- Le javascript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
    <script src="/assets/js/jquery.js"></script>
    <script src="/assets/js/bootstrap-transition.js"></script>
    <script src="/assets/js/bootstrap-alert.js"></script>
    <script src="/assets/js/bootstrap-modal.js"></script>
    <script src="/assets/js/bootstrap-dropdown.js"></script>
    <script src="/assets/js/bootstrap-scrollspy.js"></script>
    <script src="/assets/js/bootstrap-tab.js"></script>
    <script src="/assets/js/bootstrap-tooltip.js"></script>
    <script src="/assets/js/bootstrap-popover.js"></script>
    <script src="/assets/js/bootstrap-button.js"></script>
    <script src="/assets/js/bootstrap-collapse.js"></script>
    <script src="/assets/js/bootstrap-carousel.js"></script>
    <script src="/assets/js/bootstrap-typeahead.js"></script>

  </body>
</html>
